# starter-core

Это основной модуль для запуска desktop приложения. <br>
Жизненный цикл, включает следующие этапы во время запуска приложения:
<ol>
<li>Определение среды (ОС).</li>
<li>Проверка дополнительных требований к запуску (свободного места на диске, прав доступа в рабочую дирекорию, правильная установка и доступ в /temp директории, корректное отображение шрифтов, решение проблем с обновлением KB4515384 (для Windows OC)).</li>
<li>Получение конфигов для запуска приложения, таких как зависимости, файлы ресурсы, параметры запуска, аргументы запуска, версия приложения.</li>
<li>Подготовка ресурсов для запуска (обновление версии приложения), валидация текущих ресурсов по хэш-сумме, таких как зависимости и ресурсы, jre для разных ОС и загрузка несуществующих ресурсов.</li>
<li>Запуск самого приложения.</li>
</ol>

*Может запускать в офлайн режиме, для этого конфиги кэшируются, это позволяет хранить большинство конфигов на стороне сервера.<br>

Класс by.dgev.Main имеет следующие аргументы которые можно изменить:<br>

| Аргумент | По умолчанию | Описание |
| :------: | :-----------: | :-------: |
| -appName| starter | Название директории, в которую будте устанавливаться приложение. |  
| -memory| 500 | Размер необходимого свободного места на диске для загрузки приложения |  
| -uriAppConfig| http://127.0.0.1:80/starter-app/, http://127.0.0.1:81/starter-app/ | URI по которому доступен appConfig.json, который содержит в себе всю информациюя о запускаемом приложении, этот конфиг используется всеми приложениями по умолчанию. URI должен быть указан без версии, см. описание параметра версии|  
| -workDirectory| starter  |Рабочий каталог, в который будут загружаться необходимые для приложения файлы и в котором будет запускаться приложение|  
| -version| null | Указывает версию запускаемого приложения. Поэтому будет использоваться конфиг http://localhost:81/app/1.0/appConfig.json для версии 1.0. Таким образом, мы можем установить старые версии приложения| 
|-cacheDirectory| starter/cache  | Директория для хранения кэшированных конфигов  |  
|-testURLs| http://www.google.com, http://www.baidu.com | Список URL, которые используются для выполнения запросов. Когда некоторые URL или серверы недоступны, запрос не выполняется. Он пропустит загрузку файла и выполнение повторных запросов. Если у нас есть файл сервера http://example.com/repo, то это поле должно быть http://example.com") |
|-attempts| 3 | Количество попыток на восстановление соединения|
|-connectTimeout| 60000  |установка значения setConnectTimeout|
|-socketTimeout| 60000  |установка значения setSocketTimeout|
|-timeToLife| 600000 | Время обновления файла в секундах. После истечения данного времени файл является не актуальным |
|-stop|false| Аргумент для автоматического закрытия приложения после установки. Используется для тестов|
|-logURIService| null | Служба лога, которая может сохранять логи на сервере и возвращать ссылку. Пользователь может отправить ссылку для поддержки. Не реализует бэкэнд, самостоятельно должны принимать. ExceptionMessage#logButton=true, см. ViewSubscriber#doRequest|

Сушествует поле в StarterAppConfig.prod, цель которого, не дать использовать подписанное приложение пускатель для запуска вируса изменив параметр -uriAppConfig в starter-core модуле. Его необходимо изменять на true для продакшена.

Starter-core поддерживает возможность самообновления. Для этого, вам необходимо создать файл starterUpdate.json. Пример содержимого файла:
```
{
  "LINUX":{
	"sha1":"e5b5bbce5daf4b8f016bec661122f48e1bd03292",
	"uri":"http://127.0.0.1:81/starter-core-1.1.jar"
  },
  "WINDOWS":{
	"sha1":"574f3fc6667dc31d94d2167ab904aac27edadd09 ",
	"uri":"http://127.0.0.1:81/starter-core-1.1.jar"
  }
}
```
где:<br>
LINUX - операционная сисетма<br>
sha1 - хэш сумма файла, обновляемого файла<br>
uri - uri для загрузки файла<br>
